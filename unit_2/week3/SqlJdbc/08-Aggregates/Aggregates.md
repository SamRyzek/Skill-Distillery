## Aggregate Functions

* The _aggregate functions_ take a group of rows generated by a `SELECT` statement and calculate a single value.

* By default, aggregate functions will generate a single summary row for all values retrieved by the query.

* The most commonly used aggregate functions are:

  * COUNT(*) — Total count of all rows selected.

    * COUNT(_column_) — Total count of rows selected in which _column_ is not NULL.

  * SUM(_column_) — Sum of non-null values of column for selected rows.

  * AVG(_column_) — Average non-null value of column for selected rows.

  * MAX(_column_) — Maximum non-null value of column for selected rows.

  * MIN(_column_) — Minimum non-null value of column for selected rows.

* The _column_ may also be an expression that yields a value.

  ```sql
  SELECT SUM(amount) FROM payment
   WHERE payment_date BETWEEN '2015-01-01' AND '2015-02-01';
  ```

* Aggregate functions are sometimes called _grouping_, _column_, or _set_ functions.

* Aggregate functions can be used only in the `SELECT` clause of a query.

  * However, you can place the aggregate in a _subquery_'s `SELECT` list.

    ```sql
    SELECT c.id, first_name, last_name
      FROM customer c JOIN rental r
                        ON c.id = r.customer_id
     WHERE r.id = (SELECT MAX(rental_id) FROM payment);
    ```

* When you aggregate the values of a specific column, rows with null values for that column are skipped.

  ```sql
  SELECT COUNT(supervisor_id)
    FROM staff;
  ```

  * When all rows have null values for the rows selected, the aggregation will result in null.

* When you include the `DISTINCT` keyword with the column to be aggregated, duplicate row values for the column are removed, so that only unique values are aggregated.

  ```sql
  SELECT COUNT(DISTINCT supervisor_id)
    FROM staff;
  ```

<hr>

```sql
SELECT COUNT(*) FROM payment;
```

```sql
SELECT AVG(amount) FROM payment;
```

```sql
SELECT MIN(replacement_cost) FROM film
 WHERE department_id = 3;
```

```sql
SELECT MAX(last_name) FROM actor;
```

Multiple aggregates can be used in a single query.

```sql
SELECT MIN(amount), AVG(amount), MAX(amount)
  FROM payment
 WHERE payment_date > '2016-01-01';
```

The following query show the sovereign country of protectorate states.

```sql
SELECT sovereignty FROM country;
```

This query will return a list of sovereign countries that have protectorates.

```sql
SELECT DISTINCT sovereignty FROM country;
```

This query will return the total number of countries.

```sql
SELECT COUNT(*) FROM country;
```

This query will return the number of countries that have sovereign countries, excluding NULLs.

```sql
SELECT COUNT(sovereignty) FROM country;
```

This last query will return the number of unique sovereign countrys that have protectorates, excluding NULLS.

```sql
SELECT COUNT(DISTINCT sovereignty) FROM country;
```

[Prev](EXISTS.md) | [Up](../README.md) | [Next](GroupBy.md)
